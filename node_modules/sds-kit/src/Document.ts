import IRow = require("./interfaces/IRow");

import Collection = require("./Collection");
import Message = require("./Message");

/** Document class */
class Document {
  /** Collection > Document */
  public collection?: Collection;

  /** Document = Row */
  public row?: IRow;

  /**
   * Create Document object
   * @param {Collection} collection Collection of this Document
   * @param {IRow} row Row of sheet
   */
  constructor(collection?: Collection, row?: IRow) {
    /** Collection of this Document */
    this.collection = collection;

    /** Row */
    this.row = row;
  }

  /**
   * Get value of key
   * @param {string} key Key
   * @returns Value of Key
   */
  public get(key: string): string | undefined {
    if (this.row) {
      if (this.row.hasOwnProperty(key)) {
        return this.row[key];
      } else {
        Message.error("Get value failed.", "Key not found.", "Check key again.");
      }
    } else {
      Message.error("Get value failed.", "Row undefined.", "Execute query first.");
    }
  }
}

export = Document;
