"use strict";
const Spreadsheet = require("google-spreadsheet");
const util = require("util");
const Database = require("./Database");
const Message = require("./Message");
/** Cluster class */
class Cluster {
    /** Create Cluster object */
    constructor() { }
    /**
     * Access to database
     * @param {string} id ID of Google Spreadsheet
     * @param {ICreds} creds Creds for authorization
     * @returns Database object
     */
    async access(id, creds) {
        const spreadsheet = new Spreadsheet(id);
        await util.promisify(spreadsheet.useServiceAccountAuth)(creds);
        await util
            .promisify(spreadsheet.getInfo)()
            .catch(() => Message.error("Access failed.", "Wrong Spreadsheet ID or Authorization Creds.", "Check Spreadsheet ID and Authorization Creds again."));
        return new Database(this, spreadsheet.info ? spreadsheet : undefined);
    }
}
module.exports = Cluster;
