"use strict";
const Collection = require("./Collection");
const Message = require("./Message");
/** Database class */
class Database {
    /**
     * Create Database object
     * @param {Cluster} cluster Cluster of this Database
     * @param {ISpreadsheet} spreadsheet Spreadsheet
     */
    constructor(cluster, spreadsheet) {
        /** Cluster of this Database */
        this.cluster = cluster;
        if (spreadsheet) {
            /** Spreadsheet */
            this.spreadsheet = spreadsheet;
        }
    }
    /**
     * Access to Collection
     * @param {Collection} collection Name collection
     * @returns Collection object
     */
    collection(collection) {
        if (this.spreadsheet) {
            const sheet = this.spreadsheet.worksheets.filter(sheet => sheet.title == collection)[0];
            if (sheet) {
                return new Collection(this, sheet);
            }
            else {
                Message.error("Access collection failed.", "Name collection not found.", "Check name collection again.");
                return new Collection(this);
            }
        }
        else {
            Message.error("Access collection failed.", "Spreadsheet is undefined.", "Access to database first.");
            return new Collection(this);
        }
    }
}
module.exports = Database;
